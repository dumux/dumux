[TimeLoop]
DtInitial = 1e-3 # [s]
TEnd = 200 # [s]
CheckPoints =

[Grid]
PoreGeometry = Cube
ThroatCrossSectionShape = Circle
UpperRight = 1e-3 1e-3 1e-3
NumPores = 10 10 10
ParameterType = lognormal
MeanPoreInscribedRadius = 4.5e-5
StandardDeviationPoreInscribedRadius = 3e-6
BoundaryPoreLabels = xMin:2 xMax:3 yMin:1 yMax:1 zMin:1 zMax:1
MinThroatLength = 1e-9
DeletionProbability = 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9
RemoveThroatsOnBoundary = 0 1 2 3 4 5
PruningSeedIndices = 2 3
Sanitize = true
SanitationMode = KeepLargestCluster
DeletionRandomNumberSeed = 33
ParameterRandomNumberSeed = 22

[Problem]
Name = pnm_3d
VtpOutputFrequency = -1 # Write every n-th time step. 0 only writes a file if an invasion / snap-off occured. -1 writes every step
RegularizationDelta = 1e-1
RegularizationFunction = Spline
UseUpwindPc = false
neglectInletOutlet = true
NonWettingMassFlux = 5e-10
RegularizeExtremSaturation = true
RegSwThreshold = 1e-3

[Vtk]
AddVelocity = 1
Precision = Float64

[Newton]
#UseLineSearch = true
MaxSteps = 20
TargetSteps = 10
MaxRelativeShift = 1e-6
MaxTimeStepDivisions = 20

[InvasionState]
Verbosity = true
InvasionThetaThreshold = 1e-14
BlockNonwettingPhaseAtThroatLabel = 3

[SpatialParams]
SurfaceTension = 0.0725
RegularizationLowSw = 0.01
RegularizationHighSw = 0.99
HighSwRegularizationMethod = Spline

[Component]
LiquidDensity = 1000
LiquidDynamicViscosity = 1e-3
