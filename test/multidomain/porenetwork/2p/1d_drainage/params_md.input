[TimeLoop]
DtInitial = 0.1 # [s]
CheckPoints =
TEnd = 500 # [s]

[Grid]
PoreGeometry = Cube
ThroatCrossSectionShape = Circle
LowerLeft = 0
UpperRight = 4.5e-3
NumPores = 10
MeanPoreInscribedRadius = 200e-6
ThroatInscribedRadius = 100e-6
StandardDeviationPoreInscribedRadius = 0
BoundaryPoreLabels = xMin:2 xMax:1

[Problem]
VtpOutputFrequency = -1
EnableGravity = false
CapillaryPressure = 5000
NonWettingMassFlux = 5e-10

[Pnm.Problem]
Name = test_pnm_2p_md
RegularizationDelta = 1e-4

[Constraint.Problem]
Name = test_pnm_2p_md_constraint

[Newton]
MaxSteps = 10
TargetSteps = 4
#UseLineSearch = true
MaxRelativeShift = 1e-5
MaxTimeStepDivisions = 20

[InvasionState]
Verbosity = true
#BlockNonwettingPhaseAtThroatLabel = 1
InvasionThetaThreshold = 1e-11

[SpatialParams]
RegularizationLowSw = 0.01
RegularizationHighSw = 0.9
HighSwRegularizationMethod = Spline

[Component]
LiquidKinematicViscosity = 1e-7
LiquidDensity = 1000
