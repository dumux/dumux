[TimeLoop]
DtInitial = 1e-5 # [s]
TEnd = 1e6 # [s]
MaxTimeStepSize = 1e6
MaxDtNonEquilibrium = 1e-3
CheckPoints =

[Grid]
PoreGeometry = Cube
ThroatCrossSectionShape = Square
UpperRight = 1e-3 1e-3 1e-3
NumPores = 10 10 10
ParameterType = lognormal
MeanPoreInscribedRadius = 4.5e-5
StandardDeviationPoreInscribedRadius = 3e-6
BoundaryPoreLabels = xMin:2 xMax:3 yMin:1 yMax:1 zMin:1 zMax:1
MinThroatLength = 1e-9
DeletionProbability = 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9
RemoveThroatsOnBoundary = 0 1 2 3 4 5
PruningSeedIndices = 2 3
Sanitize = true
#SanitationMode = KeepLargestCluster
DeletionRandomNumberSeed = 33
ParameterRandomNumberSeed = 22

[Problem]
Name = pnm_3d
VtpOutputFrequency = -1 # Write every n-th time step. 0 only writes a file if an invasion / snap-off occured. -1 writes every step
InitialPc = 4000
FinalPc = 6000
NumSteps = 10
RegularizationDelta = 1e-1
RegularizationFunction = Spline
EnableGravity = false
UseUpwindPc = false
neglectInletOutlet = true
PrintMatrix = false

[Vtk]
AddVelocity = 1

[Newton]
UseLineSearch = false
MaxSteps = 10
TargetSteps = 4
MaxRelativeShift = 1e-4
MaxTimeStepDivisions = 50
PlausibilityCheck = true

[InvasionState]
Verbosity = true
InvasionThetaThreshold = 1e-10
BlockNonwettingPhaseAtThroatLabel = 3
RestrictInvasionToGlobalCapillaryPressure = false

[Assembly]
NumericDifference.BaseEpsilon = 1e-10

[Component]
LiquidDynamicViscosity = 1e-3
LiquidDensity = 1000

[SpatialParams]
SurfaceTension = 0.0725
RegularizationLowSw = 0.01
RegularizationHighSw = 0.99
HighSwRegularizationMethod = Spline
