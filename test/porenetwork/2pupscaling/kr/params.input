[TimeLoop]
DtInitial = 1e-5 # [s]
TEnd = 10e6 # [s]
MaxTimeStepSize = 1e2

#[Grid]
#File = ./grids/pnm_converted.dgf
#PoreGeometry = Cube
#ThroatCrossSectionShape = Square

[Grid]
PoreGeometry = Cube
ThroatCrossSectionShape = Square

UpperRight = 2e-3 2e-3 2e-3
NumPores = 4 2 2

ParameterType = lognormal
MeanPoreInscribedRadius = 4.5e-5
StandardDeviationPoreInscribedRadius = 1e-5

BoundaryFaceMarker = 2 3 1 1 1 1
MinThroatLength = 1e-9
DeletionProbability = 0.0 0.0 0.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
RemoveThroatsOnBoundary = 0 1 #2 3 4 5
PruningSeedIndices = 2 3
Sanitize = true
DeletionRandomNumberSeed = 33

[Problem]
Name = test_pnm_2p
VtpOutputFrequency = -1 # Write every n-th time step. 0 only writes a file if an invasion / snap-off occurred. -1 writes every step
EnableGravity = false
CapillaryPressure = 5000
InitialPc = 3000
FinalPc = 5000
NumSteps = 1
UseFixedPressureAndSaturationBoundary = false
Pressure = 1e5
SaturationWetting = 1.0
MinSource = 0.0   # m3/s
MaxSource = 5e-5 # m3/s

[Vtk]
AddVelocity = 1

[Newton]
UseLineSearch = true
NewtonOutputFilename = NewtonLog.txt
NewtonOverview = NewtonOverview.txt
MaxSteps = 10
TargetSteps = 7
MaxRelativeShift = 1e-4
MaxTimeStepDivisions = 40
PlausibilityCheck = false

[Regularization]
RegPercentage = 1e-2

[InvasionState]
Verbosity = true
#AccuracyCriterion = 0.99

[SpatialParams]
RegularizationLowSw = 0.0001
RegularizationHighSw = 0.99999
HighSwRegularizationMethod = Spline

