<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>README</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide section level2">

<!-- Important: This file has been automatically generated by generate_example_docs.py. Do not edit this file directly! -->
</div>
<div id="shallow-water-flow-with-bottom-friction" class="title-slide slide section level1">
<h1>Shallow water flow with bottom friction</h1>
<p>In this example, the shallow water flow model is applied to simulate a steady subcritical flow including bottom friction (bed shear stress).</p>
<p><strong>You will learn how to</strong></p>
<ul>
<li>solve a shallow water flow problem including bottom friction</li>
<li>compute and output (VTK) an analytical reference solution</li>
</ul>
<p><strong>Result</strong>. The numerical and analytical solutions for the free surface will look like this:</p>
<figure>
<center>
<img src="img/swe_result.png" alt="Shallow water result" width="60%"/>
<figcaption>
<b> Fig.1 </b> - Setup and result for the shallow water problem with bottom friction.
</figcaption>
</center>
</figure>
<p><strong>Table of contents</strong>. This description is structured as follows:</p>
<p>[[<em>TOC</em>]]</p>
</div>
<div id="problem-set-up" class="slide section level2">
<h1>Problem set-up</h1>
<h3 id="model-domain">Model domain</h3>
<p>The model domain is given by a rough channel with a slope of 0.001. The domain is 500 meters long and 5 meters wide. The bottom altitude is 10 m at the inflow and hence 9.5 m at the outflow. Bottom friction is considered by applying Manning’s law (<span class="math inline">$`n`$</span> = 0.025).</p>
<h3 id="boundary-conditions">Boundary conditions</h3>
<p>At the lateral sides a no-flow boundary condition is applied. Also no friction is considered there and therefore a no slip boundary condition is applied. These are the default boundary condition for the shallow water model. At the left border a discharge boundary condition is applied as inflow boundary condition with <span class="math inline">$`q = -1.0 m^2 s^{-1}`$</span>. At the right border a fixed water depth boundary condition is applied for the outflow. Normal flow is assumed, therefore the water depth at the right border is calculated using the equation of Gauckler, Manning and Strickler.</p>
<h3 id="initial-conditions">Initial conditions</h3>
<p>The initial water depth is set to 1 m, which is slightly higher than the normal flow water depth (0.87 m). Therefore, we expect a decreasing water level during the simulation until the normal flow condition is reached in the entire model domain. The initial velocity is set to zero.</p>
</div>
<div id="model-description" class="slide section level2">
<h1>Model description</h1>
<p>As mentioned above, this examples uses the shallow water equations (SWEs) to solve the problem. These are a depth averaged simplification of the Navier-Stokes equations. To calculate the bottom friction Manning’s law is used. An alternative is Nikuradse’s law, which is also implemented in DuMu<sup>x</sup>.</p>
<h3 id="shallow-water-model">Shallow water model</h3>
<p>The shallow water equations are given as:</p>
<pre class="math"><code>\frac{\partial \mathbf{U}}{\partial t} +
\frac{\partial \mathbf{F}}{\partial x} +
\frac{\partial \mathbf{G}}{\partial y} - \mathbf{S_b} - \mathbf{S_f} = 0</code></pre>
<p>where <span class="math inline">$`\mathbf{U}`$</span>, <span class="math inline">$`\mathbf{F}`$</span> and <span class="math inline">$`\mathbf{G}`$</span> defined as</p>
<pre class="math"><code>\mathbf{U} = \begin{bmatrix} h \\ uh \\ vh \end{bmatrix},
\mathbf{F} = \begin{bmatrix} hu \\ hu^2  + \frac{1}{2} gh^2 \\ huv \end{bmatrix},
\mathbf{G} = \begin{bmatrix} hv \\ huv \\ hv^2  + \frac{1}{2} gh^2 \end{bmatrix}</code></pre>
<p><span class="math inline">$`h`$</span> the water depth, <span class="math inline">$`u`$</span> the velocity in x-direction and <span class="math inline">$`v`$</span> the velocity in y-direction, <span class="math inline">$`g`$</span> is the constant of gravity.</p>
<p>The source terms for the bed slope <span class="math inline">$`\mathbf{S_b}`$</span> and friction <span class="math inline">$`\mathbf{S_f}`$</span> are given as</p>
<pre class="math"><code>\mathbf{S_b} = \begin{bmatrix} 0 \\ -gh \frac{\partial z}{\partial x}
               \\ -gh \frac{\partial z}{\partial y}\end{bmatrix},
\mathbf{S_f} = \begin{bmatrix} 0 \\ghS_{fx} \\ghS_{fy}\end{bmatrix}.</code></pre>
<p>with the bedSurface <span class="math inline">$`z`$</span>. <span class="math inline">$`S_{fx}`$</span> and <span class="math inline">$`S_{fy}`$</span> are the bed shear stess components in x- and y-direction, which are calculated by Manning’s law.</p>
<h3 id="mannings-law">Mannings law</h3>
<p>The empirical Manning model specifies the bed shear stress by the following equations:</p>
<pre class="math"><code>S_{fx} = \frac{n^2u}{R_{hy}^{4/3}} \sqrt(u^2 + v^2),

S_{fy} = \frac{n^2v}{R_{hy}^{4/3}} \sqrt(u^2 + v^2)</code></pre>
<p><span class="math inline">$`n`$</span> is Manning’s friction value and <span class="math inline">$`R_{hy}`$</span> is the hydraulic radius, which is assumed to be equal to the water depth <span class="math inline">$`h`$</span>.</p>
<h3 id="analytical-solution">Analytical solution</h3>
<p>Since normal flow conditions are assumed, the analytic solution is calculated using the equation of Gauckler, Manning and Strickler:</p>
<pre class="math"><code>v_m = n^{-1} R_{hy}^{2/3} I_s^{1/2}</code></pre>
<p>Where the mean velocity <span class="math inline">$`v_m`$</span> is given as</p>
<pre class="math"><code>v_m = \frac{q}{h}</code></pre>
<p><span class="math inline">$`I_s`$</span> is the bed slope and <span class="math inline">$`q`$</span> the unity inflow discharge.</p>
<p>Hence, the water depth <span class="math inline">$`h`$</span> can be calculated by</p>
<pre class="math"><code>h = \left(\frac{n q}{\sqrt{I_s}} \right)^{3/5}</code></pre>
<h3 id="discretisation">Discretisation</h3>
<p>For this example, a cell-centered finite volume method (cctpfa) is applied to solve the SWEs in combination with a fully-implicit time discretization. For cases where no sharp fronts or traveling waves occur it is possible to apply time steps larger than CFL number = 1 to reduce the computation time. Even if a steady state solution is considered, an implicit time stepping method is applied.</p>
</div>

<div id="implementation" class="title-slide slide section level1">
<h1>Implementation</h1>

</div>
<div id="folder-layout-and-files" class="slide section level2">
<h1>Folder layout and files</h1>
<pre><code>└── shallowwaterfriction/
    ├── CMakeLists.txt          -&gt; build system file
    ├── main.cc                 -&gt; main program flow
    ├── params.input            -&gt; runtime parameters
    ├── properties.hh           -&gt; compile time configuration
    ├── problem.hh              -&gt; boundary &amp; initial conditions
    └── spatialparams.hh        -&gt; spatial parameter fields</code></pre>
</div>
<div id="part-1-shallow-water-flow-simulation-setup" class="slide section level2">
<h1>Part 1: Shallow water flow simulation setup</h1>
<table>
<thead>
<tr class="header">
<th align="right"><a href="doc/swe.md">:arrow_right: Click to continue with part 1 of the documentation</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<div id="part-2-main-program-flow" class="slide section level2">
<h1>Part 2: Main program flow</h1>
<table>
<thead>
<tr class="header">
<th align="right"><a href="doc/main.md">:arrow_right: Click to continue with part 2 of the documentation</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</body>
</html>
